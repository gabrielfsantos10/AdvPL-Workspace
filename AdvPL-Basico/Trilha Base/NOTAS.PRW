//Includes sÃ£o os dicinonÃ¡rios do Framework da Linguagem ADVPL para "traduÃ§Ã£o" do fonte que criamos, no momento da compilaÃ§Ã£o
#INCLUDE "TOTVS.CH"
#INCLUDE "PROTHEUS.CH"
#INCLUDE "TBICONN.CH"


/*/{Protheus.doc} Notas

Rotina de CÃ¡lculo de Notas para o Treinamento na Universidade Totvs:

"PROGRAMAÃ‡ÃƒO PARA NÃƒO PROGRAMADORES"

@author rodrigo.carvalheiro
@since 09/2021
@version 1.0
/*/



//FunÃ§Ã£o principal, chamada para a execuÃ§Ã£o da rotina de notas dos alunos
User Function Notas()
//VariÃ¡veis locais
Local cAluno 
Local dInsc
Local lAtivo
Local nNotaA
Local nNOtaB
Local nNotaC
Local nMediaRet

//VariÃ¡veis Privates, escopo necessÃ¡rio para serem lidas na funÃ§Ã£o Media()
Private nQtdNotas
Private nNotaTot

//Preparar ambiente na filial selecionada
//NecessÃ¡rio quando a funÃ§Ã£o Ã© chamada diretamente do SmartClient e nÃ£o do menu dentro do Protheus
PREPARE ENVIRONMENT EMPRESA "99" FILIAL "01"

//incrementando os valores das notas e informações do aluno
cAluno := "Gabriel"
dInsc := SToD("18/05/2022")
//.T. - True
//.F. - False
lAtivo := .T.

nNotaA := 7
nNotaB := 8
nNotaC := 6
nQtdNotas := 3

nNotaTot := nNotaA + nNotaB + nNotaC
//Chamada da funÃ§Ã£o para calcular a mÃ©dia das notas
nMediaRet := u_media()

if (lAtivo)
    Do Case
        Case nMediaRet >= 7
            FWAlertInfo("Aluno: "+cAluno+" - Nota Final: "+STR(nMediaRet,5,2)+" - APROVADO "," Resultado")
        
        Case nMediaRet < 7
            FWAlertInfo("Aluno: "+cAluno+" - Nota Final: "+STR(nMediaRet,5,2)+" - REPROVADO "," Resultado")
    EndCase
else
    FWAlertInfo("Aluno: "+cAluno+" Não possui matricula!!","ERROR")
     
endif

RESET ENVIRONMENT
Return

//FunÃ§Ã£o responsÃ¡vel pelo cÃ¡lculo da mÃ©dia das notas do aluno
User Function Media()

Local nMedia

nMedia :=  nNotaTot / nQtdNotas

Return(nMedia)
